var apiKey = 'cueqNZUb3ldeWTNX7MU3Mel8UXtaAMUi';
var easypost = require('./lib/main.js')(apiKey);
var http = require('http');

http.createServer(function (req, res) {

    reqBody = '';
    req.on('data', function(chunk) {
        reqBody += chunk.toString();
    });

    req.on('end', function() {
        easypostEvent = easypost.Event.receive(reqBody);

        if(easypostEvent.description == 'tracker.updated') {
            console.log("easypostEvent.result will be a Tracker object because the 'major' version of the event description is 'tracker'.");

            console.log(easypostEvent.result);
        }
    });

    res.writeHead(200, {'Content-Type': 'text/plain'});
    res.end('Hello World\n');
}).listen(1337, '127.0.0.1');

console.log('Server running at http://127.0.0.1:1337/');
